<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.code.sys.mapper.BookCirculateMapper">

    <select id="findListPage" resultType="com.code.sys.entity.BookCirculate">
        SELECT
            bc.*,
            b.NAME AS book_name,
            d.NAME AS circulate_dept_name,
            d1.name AS dept_name
        FROM
            sys_book_circulate bc
                LEFT JOIN sys_book b ON bc.book_id = b.id
                LEFT JOIN sys_dept d ON bc.circulate_dept_id = d.id
                LEFT JOIN sys_dept d1 ON bc.dept_id = d1.id
        where 1=1
            <if test="type == 0">
                and bc.circulate_dept_id = #{deptId}
            </if>
            <if test="type == 1">
                and bc.dept_id = #{deptId}
            </if>
    </select>
</mapper>
